{% extends "member_base.html" %}

{% block title %}PML Code Checker{% endblock %}

<!-- Some code for getting autocompletion working was taken from here: https://github.com/ajaxorg/ace/blob/master/demo/autocompletion.html -->


{% block head %}
	{{ super() }}
	<link href="{{url_for('static', filename='css/editor.css')}}" rel="stylesheet">
	<script src="{{url_for('static', filename='js/editor.js')}}"></script>
	<script src="{{url_for('static', filename='src-noconflict/ace.js')}}" type="text/javascript" charset="utf-8"></script>

	<script src="{{url_for('static', filename='src-noconflict/ext-language_tools.js')}}"></script>

{% endblock %}

{% block content %}
	{{super()}}
	<div class="panel panel-default">
		<div class="panel-heading">
			<h1 class ="panel-title">PML Code Checker</h1>
		</div>
		<div id="panel-body">
			
			<!-- Editor -->
			<div id="editor"></div>
			<button type="submit" class="btn btn-primary" onclick="submitData({{ url_for('main.index') }})"id="submit">Submit</button>
		
			<form action="upload" method="post" enctype="multipart/form-data" id="send">
				<button type="submit" class="btn btn-primary" >Save</button>				
				<input type="file" name="file" id ="file"> 
    				<input type="hidden" name="fileCode" style="display: none;">
		 		{% if session.changed %}
    				<input type="hidden" name="update" style="display: none;"value ="{{session['update']}}" id="update">
 				{% else %}
				<input type="hidden" name="update" style="display: none;" value ="" id="update">
           			{% endif %}

			</form>  <br />
			<script>
				ace.require("ace/ext/language_tools");
				var textarea = $('#code');
				textarea.hide();
				var textarea2 = $('input[name="fileCode"]');
				var textarea3 = $('input[name="update"]');

				var editor = ace.edit("editor");
				editor.setTheme("static/ace-master/lib/ace/theme//chrome");
				editor.session.setMode("ace/mode/c_cpp");
				editor.getSession().setValue(textarea3.val());
				
				// Update text editor when there is a change
				editor.getSession().on('change', function () {
					textarea.val(editor.getSession().getValue());
					textarea2.val(editor.getSession().getValue());
				});

				editor.setOptions({
					enableBasicAutocompletion: true,
					enableSnippets: true,
					enableLiveAutocompletion: false
				});

				textarea.val(editor.getSession().getValue());
				textarea2.val(editor.getSession().getValue());
			</script>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
			<h1 class ="panel-title">PML Code Result</h1>
		</div>
			<div id="result"></div>
	</div>
{% endblock %}
